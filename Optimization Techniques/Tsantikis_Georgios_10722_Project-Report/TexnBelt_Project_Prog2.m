% ΘΕΜΑ 3 - Γενετικός Αλγόριθμος (V = 85:115)
clc; clearvars;

% Ορισμός τιμών για το V
V = 85:115;

% Ορισμός ανώτερων και κατώτερων ορίων για τη μεταβλητή x
lower_bounds = zeros(1, 17); % Όλα τα κατώτερα όρια είναι 0
upper_bounds = [54.13, 21.56, 34.08, 49.19, 33.05, 21.84, 29.96, 24.87, ...
      47.24, 33.97, 26.89, 32.76, 39.98, 37.12, 53.83, 61.65, 59.73];

upper_bounds = upper_bounds - 0.001; % Μικρή μείωση για αποφυγή ακριβούς επίτευξης του άνω ορίου

% Ορισμός περιορισμών ισότητας (Aeq * x = beq)
Aeq = [-1, -1, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0; ...
        0,  1,  0,  0,  0,  0, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0; ...
        0,  0,  0,  1,  0,  0,  0,  0, -1, -1,  0,  0,  0,  0,  0,  0,  0; ...
        1,  0,  0,  0, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0; ...
        0,  0,  1,  0,  0,  0,  0,  1,  1,  0, -1, -1, -1,  0,  0,  0,  0; ...
        0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  1, -1, -1,  0,  0; ...
        0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0, -1; ...
        0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0; ...
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  1,  1,  1];

% Αρχικοποίηση πινάκων για αποθήκευση των αποτελεσμάτων
x = zeros(length(V), 17);
fval = zeros(length(V), 1);
generations = zeros(length(V), 1);

% Επανάληψη για κάθε τιμή του V
for k = 1:length(V)
    Vt = V(k); % Τρέχουσα τιμή του V
    fprintf("Επίλυση προβλήματος για V = %d\n", Vt);
    
    % Ορισμός των σταθερών του περιορισμού ισότητας
    beq = [-Vt; 0; 0; 0; 0; 0; 0; 0; Vt];
    
    % Ορισμός της αντικειμενικής συνάρτησης (συνάρτηση κόστους)
    obj_fun = @(x) TexnBelt_Project_Fun1(x, Vt);
    
    % Επιλογές για τον γενετικό αλγόριθμο
    options = optimoptions('ga', 'ConstraintTolerance', 1e-6, 'PlotFcn', @gaplotbestf);
    
    % Εκτέλεση του γενετικού αλγόριθμου
    [xt, fvalt, exitflag, output, population, scores] = ...
        ga(obj_fun, 17, [], [], Aeq, beq, lower_bounds, upper_bounds, [], options);
    
    % Αποθήκευση των αποτελεσμάτων
    x(k, :) = xt(:);
    fval(k) = fvalt;
    generations(k) = output.generations;

    % Εκτύπωση του καλύτερου fitness για κάθε Vt
    fprintf("Βέλτιστη τιμή fitness για V = %d: %.4f\n", Vt, fval(k));
end
